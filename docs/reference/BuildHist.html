<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Build a Beta tree histogram — BuildHist • BetaTrees</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Build a Beta tree histogram — BuildHist"><meta property="og:description" content="Compute a Beta tree histogram for multivariate data at a given confidence level."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">BetaTrees</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/beta_trees.html">Creating a Beta Tree Histogram</a>
    </li>
    <li>
      <a href="../articles/mode.html">Mode Hunting Using Beta Trees</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Build a Beta tree histogram</h1>
    
    <div class="hidden name"><code>BuildHist.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute a Beta tree histogram for multivariate data at a given confidence level.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">BuildHist</span><span class="op">(</span>
  <span class="va">X</span>,
  alpha <span class="op">=</span> <span class="fl">0.1</span>,
  method <span class="op">=</span> <span class="st">"weighted_bonferroni"</span>,
  bounded <span class="op">=</span> <span class="cn">F</span>,
  plot <span class="op">=</span> <span class="cn">F</span>,
  <span class="va">...</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>X</dt>
<dd><p>A data matrix of size n by d.</p></dd>


<dt>alpha</dt>
<dd><p>Significance level, default is <code>alpha = 0.1</code>. The CI covers the average density in every region of the Beta tree histogram simultaneously with probability \(1-\alpha\).</p></dd>


<dt>method</dt>
<dd><p>Use <code>method = "bonferroni"</code> or <code>method = "weighted_bonferroni"</code>(default) to adjust for multiple hypothesis testing.</p></dd>


<dt>bounded</dt>
<dd><p>If <code>bounded = TRUE</code>, then create an initial bounding box according to user input parameters:</p><dl><dt>option</dt>
<dd><p>Define the bounding box by the order statistics (<code>option = ndat</code>) or quantiles (<code>option = qt</code>) of observations at the boundary.</p></dd>

<dt>q</dt>
<dd><p>A vector of length <code>d</code> equal to the data dimension. Order statistics or quantiles of obs. at the boundary in each dimension. E.g. for 2-dim data, <code>option = "ndat"</code> and <code>qt = c(50, 40)</code>, then the boundary in the x-axis are the 50-th and (n-50 +1)-th order statistics in the x-axis.
The boundary in the y-axis is defined by the 50-th and \(n_1 - 40 + 1\) order statistics in the y-axis for the obs. inside the boundary defined by the x-axis in the previous step.
Another way to put it is to exclude 50 obs. at the lower and upper end of x-coordinate, then for the obs. within, exclude 40 obs. at the lower and upper end of y-coordinate. If <code>option = "qt"</code> and <code>qt = c(0.05, 0.1)</code>,
then the boundary are defined by the \(\lceil 0.05 n \rceil\) and \(n - \lceil 0.05 n \rceil + 1\) quantiles in the x-axis, and then the
\(\lceil 0.1 n_1 \rceil\) and \(n_1 - \lceil 0.1 n_1 \rceil + 1\) quantiles in the y-axis among observations in the first boundary defined by x-axis.
Equivalently, exclude  \(\lceil 0.05 n \rceil\) obs. at the lower and upper end of x-coordinate, then for the obs. within, exclude  \(\lceil 0.1 n_1 \rceil\) obs. at the lower and upper end of the y-coordinate.</p></dd>


</dl></dd>


<dt>plot</dt>
<dd><p>if <code>TRUE</code> (default), plot the histogram if the data is two-dimensional.</p></dd>


<dt>...</dt>
<dd><p>Additional parameter if <code>bounded = T</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A matrix. Each row represents one regions in the histogram.
The first \(d\) columns are the lower bounds of the region; the next \(d\) columns are the upper bounds (\(d\) is data dimension);
the \(2d+1\) column stores the empirical density in the region; the next two columns  are
the lower and upper confidence bounds of the average density in the region; the last two columns are the number of obs. inside the region and the depth of the node in the k-d tree.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Construct the Beta tree histogram by (1) iteratively partitioning sample space along the sample median (similar to a k-d tree).
(2) construct <em>simultaneous</em> confidence interval (at level \(\alpha\)) for all of the regions (adjust for multiple testing with Bonferroni
or weighted Bonferroni adjustment). (3) select the largest bounded regions (w.r.t. inclusion) that that pass a goodness of fit (GOF) test, i.e.,
the empirical density lies within the confidence interval of all of the further partitions of the region (i.e., descendants of the node in the k-d tree).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="va">X</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu">BuildHist</span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Plot the histogram</span></span>
<span class="r-in"><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu">BuildHist</span><span class="op">(</span><span class="va">X</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-plt img"><img src="BuildHist-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># Set significance level and multiple hypothesis testing correction</span></span>
<span class="r-in"><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu">BuildHist</span><span class="op">(</span><span class="va">X</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"weighted_bonferroni"</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Initialize a bounding box</span></span>
<span class="r-in"><span class="va">B</span> <span class="op">&lt;-</span> <span class="fu">BuildHist</span><span class="op">(</span><span class="va">X</span>, alpha <span class="op">=</span> <span class="fl">0.05</span>, method <span class="op">=</span> <span class="st">"weighted_bonferroni"</span>,</span>
<span class="r-in">     bounded <span class="op">=</span> <span class="cn">TRUE</span>, option <span class="op">=</span> <span class="st">"ndat"</span>, qt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Qian Zhao, Guenther Walther.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

